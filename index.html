<!DOCTYPE html>
<html lang="en" itemscope itemtype="http://schema.org/WebPage">
  <head>
    

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">

  <title>gi0cann&#39;s notes - gi0cann&#39;s notes</title>
  <meta property="og:title" content="gi0cann&#39;s notes" />
  <meta name="twitter:title" content="gi0cann&#39;s notes" />
  <meta name="author" content="gi0cann"/><script type="application/ld+json">
{
    "@context": "http://schema.org",
    "@type": "WebSite",
    "name": "gi0cann&#39;s notes",
    
    "url": "https://gi0cann.github.io/"
}
</script><script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Organization",
  "name": "",
  "url": "https://gi0cann.github.io/"
  
  
  
  
}
</script>

<meta property="og:title" content="gi0cann&#39;s notes" />
<meta property="og:image" content="https://gi0cann.github.io/img/avatar-icon.png" />
<meta property="og:url" content="https://gi0cann.github.io/" />
<meta property="og:type" content="website" />
<meta property="og:site_name" content="gi0cann&#39;s notes" />
  <meta name="twitter:title" content="gi0cann&#39;s notes" />
  <meta name="twitter:image" content="https://gi0cann.github.io/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@gi0cann" />
  <meta name="twitter:creator" content="@gi0cann" />
  <link href='https://gi0cann.github.io/img/favicon.ico' rel='icon' type='image/x-icon'/>
  <meta property="og:image" content="https://gi0cann.github.io/img/avatar-icon.png" />
  <meta name="twitter:image" content="https://gi0cann.github.io/img/avatar-icon.png" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@gi0cann" />
  <meta name="twitter:creator" content="@gi0cann" />
  <meta property="og:url" content="https://gi0cann.github.io/" />
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="gi0cann&#39;s notes" />

  <meta name="generator" content="Hugo 0.53" />
  <link rel="alternate" href="https://gi0cann.github.io/index.xml" type="application/rss+xml" title="gi0cann&#39;s notes">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css" integrity="sha384-9eLZqc9ds8eNjO3TmqPeYcDj8n+Qfa4nuSiGYa6DjLNcv9BtN69ZIulL9+8CqC9Y" crossorigin="anonymous">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.5.0/css/all.css" integrity="sha384-B4dIYHKNBt8Bc12p+WXckhzcICo0wtJAoU8YZTY5qE0Id1GSseTk6S+L3BlXeVIU" crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="https://gi0cann.github.io/css/main.css" /><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" />
  <link rel="stylesheet" href="https://gi0cann.github.io/css/highlight.min.css" /><link rel="stylesheet" href="https://gi0cann.github.io/css/codeblock.css" /><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.css" integrity="sha384-h/L2W9KefUClHWaty3SLE5F/qvc4djlyR4qY3NUV5HGQBBW7stbcfff1+I/vmsHh" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/default-skin/default-skin.min.css" integrity="sha384-iD0dNku6PYSIQLyfTOpB06F2KCZJAKLOThS5HRe8b3ibhdEQ6eKsFf/EeFxdOt5R" crossorigin="anonymous">



  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top navbar-custom">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#main-navbar">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://gi0cann.github.io/">gi0cann&#39;s notes</a>
    </div>

    <div class="collapse navbar-collapse" id="main-navbar">
      <ul class="nav navbar-nav navbar-right">
        
          
            <li>
              <a title="Blog" href="/">Blog</a>
            </li>
          
        
          
            <li>
              <a title="Tags" href="/tags">Tags</a>
            </li>
          
        

        

        
      </ul>
    </div>

    
      <div class="avatar-container">
        <div class="avatar-img-border">
          <a title="gi0cann&#39;s notes" href="https://gi0cann.github.io/">
            <img class="avatar-img" src="https://gi0cann.github.io/img/avatar-icon.png" alt="gi0cann&#39;s notes" />
          </a>
        </div>
      </div>
    

  </div>
</nav>




    


<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

<div class="pswp__bg"></div>

<div class="pswp__scroll-wrap">
    
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    
    <div class="pswp__ui pswp__ui--hidden">
    <div class="pswp__top-bar">
      
      <div class="pswp__counter"></div>
      <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
      <button class="pswp__button pswp__button--share" title="Share"></button>
      <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
      <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
      
      
      <div class="pswp__preloader">
        <div class="pswp__preloader__icn">
          <div class="pswp__preloader__cut">
            <div class="pswp__preloader__donut"></div>
          </div>
        </div>
      </div>
    </div>
    <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
      <div class="pswp__share-tooltip"></div>
    </div>
    <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
    </button>
    <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
    </button>
    <div class="pswp__caption">
      <div class="pswp__caption__center"></div>
    </div>
    </div>
    </div>
</div>


  
  
  






  

  <header class="header-section ">
    
    <div class="intro-header no-img">
      <div class="container">
        <div class="row">
          <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
            <div class="page-heading">
              
                <h1>gi0cann&#39;s notes</h1>
              
              
                <hr class="small">
              
              
                
                  <span class="page-subheading">Notes about CTF, reverse engineering, binary exploitation, and web security</span>
                
              
              
            </div>
          </div>
        </div>
      </div>
    </div>
  </header>


    
  <div role="main" class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        

        <div class="posts-list">
          
          
            <article class="post-preview">
              <a href="https://gi0cann.github.io/post/35c3juniorctf-1996/">
                <h2 class="post-title">35c3 Junior CTF Pwn: 1996</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on December 30, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;2&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;426&nbsp;words
  
  
    &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;gi0cann
  
  
</span>


              <div class="post-entry">
                
                  We are giving a zip file containing the following files &ldquo;1996&rdquo; and &ldquo;1996.cpp&rdquo;. 1996 is 64 bit ELF binary and 1996.cpp contains its corresponding source code. During the ctf the target running the binary was at 35.207.132.47:22227.
1996.cpp:
// compile with -no-pie -fno-stack-protector  #include &lt;iostream&gt;#include &lt;unistd.h&gt;#include &lt;stdlib.h&gt; using namespace std; void spawn_shell() { char* args[] = {(char*)&#34;/bin/bash&#34;, NULL}; execve(&#34;/bin/bash&#34;, args, NULL); } int main() { char buf[1024]; cout &lt;&lt; &#34;Which environment variable do you want to read?
                  <a href="https://gi0cann.github.io/post/35c3juniorctf-1996/" class="post-read-more">[Read More]</a>
                
              </div>

              
                <div class="blog-tags">
                  
                    <a href="https://gi0cann.github.io//tags/ctf/">ctf</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/pwn/">pwn</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/buffer-overflow/">buffer overflow</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/stack-overflow/">stack overflow</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/linux/">linux</a>&nbsp;
                  
                </div>
              
            </article>
          
            <article class="post-preview">
              <a href="https://gi0cann.github.io/post/35c3juniorctf-flags/">
                <h2 class="post-title">35c3 Junior CTF Pwn: flags</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on December 30, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;1&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;117&nbsp;words
  
  
    &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;gi0cann
  
  
</span>


              <div class="post-entry">
                
                  We are presented with the following web page:
Looking at the code on the page we see that it take the value of the &lsquo;Accept-Language&rsquo; header and uses it to read and display the flag image.
Our goal is to provide the correct input to read the flag located at /flag on the filesystem. When we input the value for a file that doesn&rsquo;t exist we get the following error:
                  <a href="https://gi0cann.github.io/post/35c3juniorctf-flags/" class="post-read-more">[Read More]</a>
                
              </div>

              
                <div class="blog-tags">
                  
                    <a href="https://gi0cann.github.io//tags/web/">web</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/burp-suite/">burp suite</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/ctf/">ctf</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/php/">php</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/path-traversal/">path traversal</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/filter-bypass/">filter bypass</a>&nbsp;
                  
                </div>
              
            </article>
          
            <article class="post-preview">
              <a href="https://gi0cann.github.io/post/x-masctf2018-endless-christmas/">
                <h2 class="post-title">X-MasCTF 2018 RE: Endless Christmas</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on December 16, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;2&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;275&nbsp;words
  
  
    &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;gi0cann
  
  
</span>


              <div class="post-entry">
                
                  We are given the &lsquo;chall&rsquo; file.
Running the file command shows us that it&rsquo;s a 64 bit ELF binary.
We proceed to open the file with radare2:
r2 -A chall Looking at the main function we see that it creates and executes a file from the result of the function @ 0x4006a4.
main retrieve argc store in local variable local_14h retrieve argv store in local variable local_20h store &#34;fileXXXXXX&#34; in local variable template call 4006a4(0x6b7ce0, 0x601080, 0xb6b21) 0x6b7ce0 - global variable empty 0x601080 - global variable pointing to string of chars call mkstemp(template) store return value in fildes = file descriptor call fchmod(fildes, 0x1ff) call write(fildes, 0x6b7ce0, 0x12c000) call fsync(fildes) call close(fildes) call execve(template, 0x0, 0x0) return Running the chall binary generates 13 files and then prompts us for the flag.
                  <a href="https://gi0cann.github.io/post/x-masctf2018-endless-christmas/" class="post-read-more">[Read More]</a>
                
              </div>

              
                <div class="blog-tags">
                  
                    <a href="https://gi0cann.github.io//tags/re/">re</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/radare2/">radare2</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/ctf/">ctf</a>&nbsp;
                  
                </div>
              
            </article>
          
            <article class="post-preview">
              <a href="https://gi0cann.github.io/post/x-masctf2018-our-christmas-wishlist/">
                <h2 class="post-title">X-MasCTF 2018 WEB: Our Christmas Wishlist</h2>
                
                
              </a>

              <span class="post-meta">
  
  
  <i class="fas fa-calendar"></i>&nbsp;Posted on December 16, 2018
  
  
    &nbsp;|&nbsp;<i class="fas fa-clock"></i>&nbsp;3&nbsp;minutes
  
  
    &nbsp;|&nbsp;<i class="fas fa-book"></i>&nbsp;598&nbsp;words
  
  
    &nbsp;|&nbsp;<i class="fas fa-user"></i>&nbsp;gi0cann
  
  
</span>


              <div class="post-entry">
                
                  We are presented with a page with a textarea where you can input text.
We put hello in the textarea an submit the request:
We get the following response:
Taking a look at the request in burp we see the following request:
POST / HTTP/1.1 Host: 95.179.163.167:12001 User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:63.0) Gecko/20100101 Firefox/63.0 Accept: */* Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate Referer: http://95.179.163.167:12001/ Content-Type: application/xml Content-Length: 24 Connection: close Cookie: PHPSESSID=9cef815bea8ae2420273c0fbf61f3bcb &lt;message&gt;hello&lt;/message&gt; with the following response:
                  <a href="https://gi0cann.github.io/post/x-masctf2018-our-christmas-wishlist/" class="post-read-more">[Read More]</a>
                
              </div>

              
                <div class="blog-tags">
                  
                    <a href="https://gi0cann.github.io//tags/web/">web</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/burp-suite/">burp suite</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/ctf/">ctf</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/xxe/">xxe</a>&nbsp;
                  
                    <a href="https://gi0cann.github.io//tags/php/">php</a>&nbsp;
                  
                </div>
              
            </article>
          
        </div>

        
      </div>
    </div>
  </div>

    <footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <ul class="list-inline text-center footer-links">
          
              <li>
                <a href="mailto:youremail@domain.com" title="Email me">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fas fa-envelope fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://github.com/gi0cann" title="GitHub">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
              <li>
                <a href="https://twitter.com/gi0cann" title="Twitter">
                  <span class="fa-stack fa-lg">
                    <i class="fas fa-circle fa-stack-2x"></i>
                    <i class="fab fa-twitter fa-stack-1x fa-inverse"></i>
                  </span>
                </a>
              </li>
          
          <li>
            
            <a href="https://gi0cann.github.io/index.xml" title="RSS">
            
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fas fa-rss fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="credits copyright text-muted">
          
            
              <a href="https://gi0cann.github.io">gi0cann</a>
            
          

          &nbsp;&bull;&nbsp;&copy;
          
            2018
          

          
            &nbsp;&bull;&nbsp;
            <a href="https://gi0cann.github.io/">gi0cann&#39;s notes</a>
          
        </p>
        
        <p class="credits theme-by text-muted">
          <a href="http://gohugo.io">Hugo v0.53</a> powered &nbsp;&bull;&nbsp; Theme by <a href="http://deanattali.com/beautiful-jekyll/">Beautiful Jekyll</a> adapted to <a href="https://github.com/halogenica/beautifulhugo">Beautiful Hugo</a>
          
        </p>
      </div>
    </div>
  </div>
</footer>

<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.js" integrity="sha384-K3vbOmF2BtaVai+Qk37uypf7VrgBubhQreNQe9aGsz9lB63dIFiQVlJbr92dw2Lx" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/contrib/auto-render.min.js" integrity="sha384-kmZOZB5ObwgQnS/DuDg6TScgOiWWBiVt0plIRkZCmE6rDZGrEOQeHM5PcHi+nyqe" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-1.12.4.min.js" integrity="sha256-ZosEbRLbNQzLpnKIkEdrPv7lOy9C27hHQ+Xp8a4MxAQ=" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<script src="https://gi0cann.github.io/js/main.js"></script>
<script src="https://gi0cann.github.io/js/highlight.min.js"></script>
<script> hljs.initHighlightingOnLoad(); </script>
<script> $(document).ready(function() {$("pre.chroma").css("padding","0");}); </script><script> renderMathInElement(document.body); </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe.min.js" integrity="sha384-QELNnmcmU8IR9ZAykt67vGr9/rZJdHbiWi64V88fCPaOohUlHCqUD/unNN0BXSqy" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.2/photoswipe-ui-default.min.js" integrity="sha384-m67o7SkQ1ALzKZIFh4CiTA8tmadaujiTa9Vu+nqPSwDOqHrDmxLezTdFln8077+q" crossorigin="anonymous"></script>
<script src="https://gi0cann.github.io/js/load-photoswipe.js"></script>








  </body>
</html>

